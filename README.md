<div align="center">
    <h1>Телеграм-бот "КиноПоиск"</h1>
    <p>Взаимодействует с неофициальным <a href="https://kinopoisk.dev/">API КиноПоиска</a></p>
</div>

## Для работы бота потребуется:
### Установка дополнительных модулей:
- pyTelegramBotAPI (взаимодействие с API телеграм);
- python-dotenv (работа с чувствительными данными);
- requests (взаимодействие с API сайта);
- peewee (работа с БД SQLite).

### Получение токенов:
#### Телеграм-бота
- Для получения токена необходимо воспользоваться ботом [@BotFather](@BotFather)
#### Кинопоиска
- Для получения токена необходимо перейти [kinopoisk.dev](https://kinopoisk.dev/documentation.html) и написать по
контактам.

## Функции, предоставляемые пользователю:
- поиск фильма по названию;
- поиск фильма по жанру и рейтингу;
- просмотр истории запросов и результатов поиска по ним.

## Дополнительные функции бота:
- просмотр информации о БД;
- очистка БД от старых записей.

Дополнительный функционал может быть скрыт от глаз пользователя. 
В настоящее время бот поддерживает одного пользователя с такими правами, 
но при необходимости этот функционал можно расширить на группу пользователей. 
_Для удобства тестирования, команда обслуживания БД находится в списке команд у всех пользователей. 
При необходимости она может быть исключена из основного меню и справки и вызываться вручную._

## Внутреннее устройство.
Для хранения служебной информации используется SQLite в связке с OCR Peewee.
БД состоит из трех таблиц: информация о пользователях, информация о запросах, информация о фильмах.
### Особенности структуры.
- В таблице запросов содержится запись со списком фильмов, предоставленных в качестве ответа.
Таким образом, при просмотре истории запросов пользователь увидит туже выборку, что и при поиске.
- Информация о фильмах временно хранится БД, для снижения нагрузки на сайт, 
так как в данном учебном проекте используется бесплатный лимитированный доступ к API.
- Предусмотрена очистка БД, при этом удаляются все запросы старше 30 дней, 
а также все фильмы, ссылки на которые не содержатся ни в одном запросе.